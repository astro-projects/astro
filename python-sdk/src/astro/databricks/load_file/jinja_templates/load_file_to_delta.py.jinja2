from pyspark.sql.functions import input_file_name, current_timestamp

{% from 'jinja_templates/copy_into.py.jinja2' import copy_into_command -%}

src_data_path = "{{ input_path }}"
username = spark.sql("SELECT regexp_replace(current_user(), '[^a-zA-Z0-9]', '_')").first()[0]
table_name = f"{{ table_name }}" # This can be generated based on task ID and dag ID or just entirely random
checkpoint_path = f"/tmp/{username}/_checkpoint/etl_3_quickstart"

{{ copy_into_command(file_type, load_options) }}
