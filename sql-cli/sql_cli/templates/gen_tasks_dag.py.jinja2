# NOTE: This is an auto-generated file. Please do not edit this file manually.
{% from 'macros/transform_tasks.py.jinja2' import define_transform_task -%}
{% from 'macros/load_file_tasks.py.jinja2' import define_load_file_task -%}
from pathlib import Path

from airflow import DAG
from airflow.utils import timezone
from astro import sql as aql
from astro.table import Table

DAGS_FOLDER = Path(__file__).parent.as_posix()

with DAG(
    dag_id="{{ dag.dag_id }}",
    start_date=timezone.parse("{{ dag.start_date }}"),
    schedule_interval=None,
) as dag:
    {%- for workflow_file in dag.sorted_workflow_files() %}
    {% if workflow_file.__class__.__name__ == 'SqlFile'  %}
    {{ define_transform_task(workflow_file, dag)|indent(width=4) }}
    {% elif workflow_file.operator == 'load_file'  %}
    {{ define_load_file_task(workflow_file, dag, workflow_file.get_yaml_content(), workflow_file.yaml_file_name)|indent(width=4) }}
    {% endif %}
    {%- endfor %}
